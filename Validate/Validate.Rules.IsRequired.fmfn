/**
 * 
 * A rule that tests for a value at the given JSON key path
 * 
 * @param {string} key = the JSON key path to the value to test
 * @param {string} [LIST_dataTypes] = OPTIONAL: the required data type of the value; if NULL, any data type is accepted
 * 				Valid types: text, number, boolean, time, timestamp, object, array
 * 
 * @returnSuccess {NULL}
 * 
 * @returnError {object} Validate.Error: an error object
 * 
 * @module Validate
 * @requires {function} Validate._errorCreate()
 * @requires {function} Validate.Rule.IsOfType ()
 * 
 * @version 2.0.0
 * @author Allen Ulbricht, https://github.com/aulbricht
 * @credit forked from code by original author Todd Geist
 * 
 */


Let ([

	~key = key ;
	~list = LIST_dataTypes ;
	~dataToValidate = $$validate.this ;

	~value = JSONGetElement( ~dataToValidate ; ~key  )

];

Case (

	// if either A) the parameter data is NULL or the extracted value is NULL, return an error
	IsEmpty ( ~dataToValidate ) or IsEmpty ( ~value ) ; Validate._errorCreate ( ~key ; "Required value is missing"  ) ; 

	// if a data type parameter was included, validate that it matches the given value's data type
	not IsEmpty ( ~list ) ; Validate.Rule.IsOfType ( ~key ; ~list ); 

	// default return NULL
	""
)

)